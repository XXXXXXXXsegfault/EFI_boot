#ifndef _My_OS_memcpy_
#define _My_OS_memcpy_
void *memcpy(void *dst,void *src,unsigned long long int size);
asm("memcpy:");
asm("push %rcx");
asm("push %rdx");
asm("push %rbx");
asm("push %rbp");
asm("push %rsi");
asm("push %rdi");
asm("cmp $8,%rdx");
asm("jb _memcpy_X1");
asm("mov %sil,%al");
asm("and $7,%al");
asm("je _memcpy_X3");
asm("or $0xf8,%al");
asm("mov (%rsi),%ah");
asm("mov %ah,(%rdi)");
asm("inc %rsi");
asm("inc %rdi");
asm("dec %rdx");
asm("inc %al");
asm("je _memcpy_X3");
asm("mov (%rsi),%ah");
asm("mov %ah,(%rdi)");
asm("inc %rsi");
asm("inc %rdi");
asm("dec %rdx");
asm("inc %al");
asm("je _memcpy_X3");
asm("mov (%rsi),%ah");
asm("mov %ah,(%rdi)");
asm("inc %rsi");
asm("inc %rdi");
asm("dec %rdx");
asm("inc %al");
asm("je _memcpy_X3");
asm("mov (%rsi),%ah");
asm("mov %ah,(%rdi)");
asm("inc %rsi");
asm("inc %rdi");
asm("dec %rdx");
asm("inc %al");
asm("je _memcpy_X3");
asm("mov (%rsi),%ah");
asm("mov %ah,(%rdi)");
asm("inc %rsi");
asm("inc %rdi");
asm("dec %rdx");
asm("inc %al");
asm("je _memcpy_X3");
asm("mov (%rsi),%ah");
asm("mov %ah,(%rdi)");
asm("inc %rsi");
asm("inc %rdi");
asm("dec %rdx");
asm("inc %al");
asm("je _memcpy_X3");
asm("mov (%rsi),%ah");
asm("mov %ah,(%rdi)");
asm("inc %rsi");
asm("inc %rdi");
asm("dec %rdx");
asm("_memcpy_X3:");
asm("mov %rsp,%rbp");
asm("mov %rsi,%rsp");
asm("_memcpy_X4:");
asm("sub $64,%rdx");
asm("jb _memcpy_X5");
asm("pop %rax");
asm("pop %rcx");
asm("pop %rbx");
asm("pop %rsi");
asm("mov %rax,(%rdi)");
asm("mov %rcx,8(%rdi)");
asm("mov %rbx,16(%rdi)");
asm("mov %rsi,24(%rdi)");
asm("pop %rax");
asm("pop %rcx");
asm("pop %rbx");
asm("pop %rsi");
asm("mov %rax,32(%rdi)");
asm("mov %rcx,40(%rdi)");
asm("mov %rbx,48(%rdi)");
asm("mov %rsi,56(%rdi)");
asm("lea 64(%rdi),%rdi");
asm("jmp _memcpy_X4");
asm("_memcpy_X5:");
asm("mov %rsp,%rsi");
asm("mov %rbp,%rsp");
asm("test $32,%dl");
asm("je _memcpy_Y1");
asm("mov (%rsi),%rax");
asm("mov 8(%rsi),%rcx");
asm("mov %rax,(%rdi)");
asm("mov %rcx,8(%rdi)");
asm("mov 16(%rsi),%rax");
asm("mov 24(%rsi),%rcx");
asm("mov %rax,16(%rdi)");
asm("mov %rcx,24(%rdi)");
asm("lea 32(%rdi),%rdi");
asm("lea 32(%rsi),%rsi");
asm("_memcpy_Y1:");
asm("test $16,%dl");
asm("je _memcpy_Y2");
asm("mov (%rsi),%rax");
asm("mov 8(%rsi),%rcx");
asm("mov %rax,(%rdi)");
asm("mov %rcx,8(%rdi)");
asm("lea 16(%rdi),%rdi");
asm("lea 16(%rsi),%rsi");
asm("_memcpy_Y2:");
asm("test $8,%dl");
asm("je _memcpy_Y3");
asm("mov (%rsi),%rax");
asm("mov %rax,(%rdi)");
asm("lea 8(%rdi),%rdi");
asm("lea 8(%rsi),%rsi");
asm("_memcpy_Y3:");
asm("and $7,%dl");
asm("_memcpy_X1:");
asm("test %dl,%dl");
asm("je _memcpy_X2");
asm("mov (%rsi),%al");
asm("mov %al,(%rdi)");
asm("inc %rdi");
asm("inc %rsi");
asm("dec %dl");
asm("je _memcpy_X2");
asm("mov (%rsi),%al");
asm("mov %al,(%rdi)");
asm("inc %rdi");
asm("inc %rsi");
asm("dec %dl");
asm("je _memcpy_X2");
asm("mov (%rsi),%al");
asm("mov %al,(%rdi)");
asm("inc %rdi");
asm("inc %rsi");
asm("dec %dl");
asm("je _memcpy_X2");
asm("mov (%rsi),%al");
asm("mov %al,(%rdi)");
asm("inc %rdi");
asm("inc %rsi");
asm("dec %dl");
asm("je _memcpy_X2");
asm("mov (%rsi),%al");
asm("mov %al,(%rdi)");
asm("inc %rdi");
asm("inc %rsi");
asm("dec %dl");
asm("je _memcpy_X2");
asm("mov (%rsi),%al");
asm("mov %al,(%rdi)");
asm("inc %rdi");
asm("inc %rsi");
asm("dec %dl");
asm("je _memcpy_X2");
asm("mov (%rsi),%al");
asm("mov %al,(%rdi)");
asm("inc %rdi");
asm("_memcpy_X2:");
asm("mov %rdi,%rax");
asm("pop %rdi");
asm("pop %rsi");
asm("pop %rbp");
asm("pop %rbx");
asm("pop %rdx");
asm("pop %rcx");
asm("ret");
#endif
